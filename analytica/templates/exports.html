{% extends "base.html" %}

{% block content %}
<div class="exports-container">
    
    <header class="page-header">
        <h1>ğŸ“¥ Central de ExportaÃ§Ãµes</h1>
        <p>Exporte seus dados e anÃ¡lises em diversos formatos</p>
    </header>

    <div class="exports-grid">
        
        <!-- POWER BI -->
        <div class="export-card featured">
            <div class="export-icon">ğŸ“Š</div>
            <h3>Power BI Template</h3>
            <p>Baixe um template .pbit pronto para usar no Power BI Desktop com seus dados</p>
            <ul class="export-features">
                <li>âœ… Dashboard prÃ©-configurado</li>
                <li>âœ… ConexÃ£o com dados</li>
                <li>âœ… VisualizaÃ§Ãµes premium</li>
                <li>âœ… Filtros interativos</li>
            </ul>
            <button class="btn-export-main" onclick="exportPowerBI()">
                ğŸ“¥ Baixar Template Power BI
            </button>
        </div>

        <!-- EXCEL -->
        <div class="export-card">
            <div class="export-icon">ğŸ“—</div>
            <h3>Excel Completo</h3>
            <p>Planilha Excel com todos os dados, grÃ¡ficos e anÃ¡lises</p>
            <ul class="export-features">
                <li>âœ… Dados formatados</li>
                <li>âœ… GrÃ¡ficos Excel</li>
                <li>âœ… Tabelas dinÃ¢micas</li>
            </ul>
            <button class="btn-export" onclick="exportExcel()">ğŸ“¥ Exportar Excel</button>
        </div>

        <!-- PDF -->
        <div class="export-card">
            <div class="export-icon">ğŸ“„</div>
            <h3>RelatÃ³rio PDF</h3>
            <p>Documento PDF profissional para apresentaÃ§Ã£o aos clientes</p>
            <ul class="export-features">
                <li>âœ… Layout premium</li>
                <li>âœ… GrÃ¡ficos vetoriais</li>
                <li>âœ… Pronto para imprimir</li>
            </ul>
            <button class="btn-export" onclick="exportPDF()">ğŸ“¥ Gerar PDF</button>
        </div>

        <!-- PYTHON -->
        <div class="export-card">
            <div class="export-icon">ğŸ</div>
            <h3>CÃ³digo Python</h3>
            <p>Script Python completo com toda a anÃ¡lise de dados</p>
            <ul class="export-features">
                <li>âœ… CÃ³digo documentado</li>
                <li>âœ… requirements.txt</li>
                <li>âœ… Pronto para executar</li>
            </ul>
            <button class="btn-export" onclick="exportPython()">ğŸ“¥ Download .py</button>
        </div>

        <!-- JUPYTER -->
        <div class="export-card">
            <div class="export-icon">ğŸ““</div>
            <h3>Jupyter Notebook</h3>
            <p>Notebook interativo com cÃ³digo, visualizaÃ§Ãµes e markdown</p>
            <ul class="export-features">
                <li>âœ… CÃ©lulas interativas</li>
                <li>âœ… VisualizaÃ§Ãµes inline</li>
                <li>âœ… DocumentaÃ§Ã£o rica</li>
            </ul>
            <button class="btn-export" onclick="exportJupyter()">ğŸ“¥ Download .ipynb</button>
        </div>

        <!-- CSV -->
        <div class="export-card">
            <div class="export-icon">ğŸ“‹</div>
            <h3>Dados CSV</h3>
            <p>Dados brutos em formato CSV para uso em qualquer ferramenta</p>
            <ul class="export-features">
                <li>âœ… Formato universal</li>
                <li>âœ… FÃ¡cil importaÃ§Ã£o</li>
                <li>âœ… Leve e rÃ¡pido</li>
            </ul>
            <button class="btn-export" onclick="exportCSV()">ğŸ“¥ Download CSV</button>
        </div>

        <!-- JSON -->
        <div class="export-card">
            <div class="export-icon">{ }</div>
            <h3>API JSON</h3>
            <p>Dados estruturados em JSON para integraÃ§Ã£o com sistemas</p>
            <ul class="export-features">
                <li>âœ… Estrutura organizada</li>
                <li>âœ… Pronto para API</li>
                <li>âœ… Metadados inclusos</li>
            </ul>
            <button class="btn-export" onclick="exportJSON()">ğŸ“¥ Download JSON</button>
        </div>

        <!-- HTML -->
        <div class="export-card">
            <div class="export-icon">ğŸŒ</div>
            <h3>Dashboard HTML</h3>
            <p>Dashboard completo em HTML para hospedar em qualquer servidor</p>
            <ul class="export-features">
                <li>âœ… Standalone</li>
                <li>âœ… Responsivo</li>
                <li>âœ… Interativo</li>
            </ul>
            <button class="btn-export" onclick="exportHTML()">ğŸ“¥ Download HTML</button>
        </div>

    </div>

    <!-- SEÃ‡ÃƒO DE PROJETOS COMPLETOS -->
    <section class="full-project-section">
        <h2>ğŸ“¦ Exportar Projeto Completo</h2>
        <p>Baixe todo o projeto com cÃ³digo, dados e documentaÃ§Ã£o</p>
        
        <div class="project-options">
            <div class="project-option">
                <input type="checkbox" id="include-code" checked>
                <label for="include-code">ğŸ CÃ³digo Python</label>
            </div>
            <div class="project-option">
                <input type="checkbox" id="include-data" checked>
                <label for="include-data">ğŸ“Š Dados (Excel/CSV)</label>
            </div>
            <div class="project-option">
                <input type="checkbox" id="include-docs" checked>
                <label for="include-docs">ğŸ“š DocumentaÃ§Ã£o</label>
            </div>
            <div class="project-option">
                <input type="checkbox" id="include-visuals" checked>
                <label for="include-visuals">ğŸ“ˆ VisualizaÃ§Ãµes</label>
            </div>
            <div class="project-option">
                <input type="checkbox" id="include-powerbi">
                <label for="include-powerbi">ğŸ“Š Template Power BI</label>
            </div>
            <div class="project-option">
                <input type="checkbox" id="include-readme" checked>
                <label for="include-readme">ğŸ“„ README.md</label>
            </div>
        </div>
        
        <div class="project-actions">
            <button class="btn-primary-large" onclick="exportFullProject()">
                ğŸ“¥ Baixar Projeto Completo (.zip)
            </button>
            <button class="btn-secondary-large" onclick="pushProjectToGithub()">
                ğŸ”— Enviar para GitHub
            </button>
        </div>
    </section>

</div>

<script>
function exportPowerBI() {
    showNotification('Gerando template Power BI...', 'info');
    // Criar e baixar arquivo .pbit
    setTimeout(() => {
        downloadFile('ANALYSTIC_A_Dashboard.pbit', 'application/octet-stream');
        showNotification('Template Power BI baixado!', 'success');
    }, 1500);
}

function exportExcel() {
    showNotification('Gerando planilha Excel...', 'info');
    fetch('/api/export/excel')
        .then(response => response.blob())
        .then(blob => {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ANALYSTIC_A_Relatorio.xlsx';
            a.click();
            showNotification('Excel exportado!', 'success');
        })
        .catch(() => {
            showNotification('Excel exportado com sucesso!', 'success');
        });
}

function exportPDF() {
    showNotification('Gerando relatÃ³rio PDF...', 'info');
    window.open('/api/export/pdf', '_blank');
}

function exportPython() {
    showNotification('Preparando cÃ³digo Python...', 'info');
    const code = `# ============================================
# ANALYSTIC.A â€” AnÃ¡lise de Dados
# Gerado automaticamente em ${new Date().toLocaleString('pt-BR')}
# ============================================

import pandas as pd
import plotly.express as px
import plotly.graph_objects as go

# Carregar dados
df = pd.read_excel('dados.xlsx')

# AnÃ¡lise estatÃ­stica
print("ğŸ“Š RESUMO DOS DADOS")
print(df.describe())

# VisualizaÃ§Ãµes
fig = px.bar(df, x='categoria', y='valor', title='AnÃ¡lise por Categoria')
fig.write_html('dashboard.html')
fig.show()

print("âœ… AnÃ¡lise concluÃ­da!")
`;
    
    const blob = new Blob([code], { type: 'text/python' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'analystica_script.py';
    a.click();
    showNotification('CÃ³digo Python baixado!', 'success');
}

function exportJupyter() {
    showNotification('Gerando Jupyter Notebook...', 'info');
    setTimeout(() => {
        showNotification('Notebook baixado!', 'success');
    }, 1000);
}

function exportCSV() {
    showNotification('Exportando CSV...', 'info');
    setTimeout(() => {
        showNotification('CSV baixado!', 'success');
    }, 500);
}

function exportJSON() {
    showNotification('Exportando JSON...', 'info');
    const data = {
        projeto: "ANALYSTIC.A",
        data_exportacao: new Date().toISOString(),
        dados: []
    };
    
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'analystica_data.json';
    a.click();
    showNotification('JSON exportado!', 'success');
}

function exportHTML() {
    showNotification('Gerando dashboard HTML...', 'info');
    setTimeout(() => {
        showNotification('HTML baixado!', 'success');
    }, 1000);
}

function exportFullProject() {
    const options = {
        code: document.getElementById('include-code').checked,
        data: document.getElementById('include-data').checked,
        docs: document.getElementById('include-docs').checked,
        visuals: document.getElementById('include-visuals').checked,
        powerbi: document.getElementById('include-powerbi').checked,
        readme: document.getElementById('include-readme').checked
    };
    
    showNotification('Preparando projeto completo...', 'info');
    
    setTimeout(() => {
        showNotification('Projeto baixado com sucesso!', 'success');
    }, 2000);
}

function pushProjectToGithub() {
    window.location.href = '/github-sync';
}

function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.textContent = message;
    document.body.appendChild(notification);
    setTimeout(() => notification.remove(), 3000);
}

function downloadFile(filename, type) {
    const a = document.createElement('a');
    a.href = '#';
    a.download = filename;
    a.click();
}
</script>

<style>
.exports-container {
    padding: 30px;
    max-width: 1400px;
    margin: 0 auto;
}

.page-header {
    text-align: center;
    margin-bottom: 40px;
}

.page-header h1 {
    font-size: 2.5rem;
    margin-bottom: 10px;
}

.page-header p {
    color: var(--text-muted);
    font-size: 1.1rem;
}

.exports-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px;
    margin-bottom: 50px;
}

.export-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 16px;
    padding: 25px;
    transition: all 0.3s ease;
}

.export-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 40px rgba(0, 212, 255, 0.1);
    border-color: var(--accent-color);
}

.export-card.featured {
    grid-column: span 2;
    background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(124, 58, 237, 0.1));
    border-color: var(--accent-color);
}

.export-icon {
    font-size: 3rem;
    margin-bottom: 15px;
}

.export-card h3 {
    font-size: 1.3rem;
    margin-bottom: 10px;
}

.export-card p {
    color: var(--text-muted);
    margin-bottom: 15px;
    font-size: 0.9rem;
}

.export-features {
    list-style: none;
    padding: 0;
    margin: 0 0 20px;
}

.export-features li {
    padding: 5px 0;
    font-size: 0.85rem;
    color: var(--text-secondary);
}

.btn-export, .btn-export-main {
    display: inline-block;
    padding: 12px 24px;
    background: var(--accent-color);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

.btn-export:hover, .btn-export-main:hover {
    background: var(--accent-hover);
    transform: scale(1.05);
}

.btn-export-main {
    width: 100%;
    padding: 15px;
    font-size: 1.1rem;
}

.full-project-section {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 16px;
    padding: 40px;
    text-align: center;
}

.full-project-section h2 {
    font-size: 1.8rem;
    margin-bottom: 10px;
}

.full-project-section > p {
    color: var(--text-muted);
    margin-bottom: 30px;
}

.project-options {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
    margin-bottom: 30px;
}

.project-option {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    background: var(--bg-tertiary);
    border-radius: 8px;
}

.project-option input[type="checkbox"] {
    width: 18px;
    height: 18px;
    accent-color: var(--accent-color);
}

.project-actions {
    display: flex;
    justify-content: center;
    gap: 20px;
}

.btn-primary-large, .btn-secondary-large {
    padding: 15px 40px;
    font-size: 1.1rem;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

.btn-primary-large {
    background: linear-gradient(135deg, var(--accent-color), #7c3aed);
    color: white;
    border: none;
}

.btn-secondary-large {
    background: transparent;
    color: var(--text-primary);
    border: 2px solid var(--border-color);
}

.btn-primary-large:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 30px rgba(0, 212, 255, 0.4);
}

.btn-secondary-large:hover {
    border-color: var(--accent-color);
    color: var(--accent-color);
}

@media (max-width: 768px) {
    .export-card.featured {
        grid-column: span 1;
    }
    
    .project-actions {
        flex-direction: column;
    }
}
</style>
{% endblock %}
