{% extends "base.html" %}

{% block content %}
<div class="docs-container">
    
    <header class="page-header">
        <h1>üìö Documenta√ß√£o do Projeto</h1>
        <p>Gere documenta√ß√£o profissional para entregar aos seus clientes</p>
    </header>

    <div class="docs-layout">
        
        <!-- SIDEBAR: NAVEGA√á√ÉO -->
        <aside class="docs-sidebar">
            <h3>üìë Se√ß√µes</h3>
            <nav class="docs-nav">
                <a href="#overview" class="nav-item active">üìä Vis√£o Geral</a>
                <a href="#data" class="nav-item">üìÅ Dados Utilizados</a>
                <a href="#analysis" class="nav-item">üîç An√°lises Realizadas</a>
                <a href="#results" class="nav-item">üìà Resultados</a>
                <a href="#code" class="nav-item">üêç C√≥digo Python</a>
                <a href="#charts" class="nav-item">üìä Visualiza√ß√µes</a>
                <a href="#conclusions" class="nav-item">‚úÖ Conclus√µes</a>
                <a href="#next-steps" class="nav-item">üöÄ Pr√≥ximos Passos</a>
            </nav>
            
            <div class="export-sidebar">
                <h4>üì• Exportar Documenta√ß√£o</h4>
                <button class="btn-export-doc" onclick="exportDocPDF()">üìÑ PDF</button>
                <button class="btn-export-doc" onclick="exportDocHTML()">üåê HTML</button>
                <button class="btn-export-doc" onclick="exportDocMD()">üìù Markdown</button>
                <button class="btn-export-doc" onclick="exportDocWord()">üìò Word</button>
            </div>
        </aside>

        <!-- CONTE√öDO PRINCIPAL -->
        <main class="docs-content">
            
            <!-- VIS√ÉO GERAL -->
            <section id="overview" class="doc-section">
                <h2>üìä Vis√£o Geral do Projeto</h2>
                
                <div class="project-info-card">
                    <div class="info-row">
                        <span class="info-label">Nome do Projeto:</span>
                        <span class="info-value" contenteditable="true">An√°lise de Dados - Cliente XYZ</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Cliente:</span>
                        <span class="info-value" contenteditable="true">Empresa XYZ Ltda</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Data de Cria√ß√£o:</span>
                        <span class="info-value">05/12/2025</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Analista Respons√°vel:</span>
                        <span class="info-value" contenteditable="true">{{ user }}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Vers√£o:</span>
                        <span class="info-value">1.0.0</span>
                    </div>
                </div>
                
                <h3>Resumo Executivo</h3>
                <div class="editable-content" contenteditable="true">
                    <p>Este relat√≥rio apresenta uma an√°lise completa dos dados fornecidos pelo cliente, incluindo tend√™ncias de crescimento, m√©tricas de desempenho e insights estrat√©gicos para tomada de decis√£o.</p>
                    <p>Os principais destaques incluem:</p>
                    <ul>
                        <li>Crescimento de 48.9% no faturamento ao longo do per√≠odo analisado</li>
                        <li>Identifica√ß√£o de 3 segmentos principais de clientes</li>
                        <li>Proje√ß√£o de crescimento para os pr√≥ximos 6 meses</li>
                    </ul>
                </div>
            </section>

            <!-- DADOS UTILIZADOS -->
            <section id="data" class="doc-section">
                <h2>üìÅ Dados Utilizados</h2>
                
                <h3>Fontes de Dados</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Arquivo</th>
                            <th>Tipo</th>
                            <th>Registros</th>
                            <th>Per√≠odo</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>vendas_2025.xlsx</td>
                            <td>Excel</td>
                            <td>15.420</td>
                            <td>Jan-Dez 2025</td>
                        </tr>
                        <tr>
                            <td>clientes.csv</td>
                            <td>CSV</td>
                            <td>3.847</td>
                            <td>Atualizado</td>
                        </tr>
                        <tr>
                            <td>produtos.json</td>
                            <td>JSON</td>
                            <td>248</td>
                            <td>Cat√°logo atual</td>
                        </tr>
                    </tbody>
                </table>
                
                <h3>Dicion√°rio de Dados</h3>
                <div class="code-block">
                    <pre>
# Principais colunas utilizadas:
- data: Data da transa√ß√£o (datetime)
- cliente_id: Identificador √∫nico do cliente (int)
- produto_id: Identificador do produto (int)
- valor: Valor da venda em R$ (float)
- categoria: Categoria do produto (string)
- regiao: Regi√£o do cliente (string)
                    </pre>
                </div>
            </section>

            <!-- AN√ÅLISES REALIZADAS -->
            <section id="analysis" class="doc-section">
                <h2>üîç An√°lises Realizadas</h2>
                
                <div class="analysis-cards">
                    <div class="analysis-card">
                        <span class="analysis-icon">üìà</span>
                        <h4>An√°lise de Tend√™ncias</h4>
                        <p>Identifica√ß√£o de padr√µes de crescimento e sazonalidade nas vendas.</p>
                    </div>
                    
                    <div class="analysis-card">
                        <span class="analysis-icon">üë•</span>
                        <h4>Segmenta√ß√£o de Clientes</h4>
                        <p>Agrupamento de clientes por comportamento de compra usando K-Means.</p>
                    </div>
                    
                    <div class="analysis-card">
                        <span class="analysis-icon">üéØ</span>
                        <h4>An√°lise de Pareto</h4>
                        <p>Identifica√ß√£o dos produtos e clientes que geram 80% da receita.</p>
                    </div>
                    
                    <div class="analysis-card">
                        <span class="analysis-icon">üîÆ</span>
                        <h4>Previs√£o de Vendas</h4>
                        <p>Modelo preditivo para proje√ß√£o de vendas nos pr√≥ximos 6 meses.</p>
                    </div>
                </div>
            </section>

            <!-- RESULTADOS -->
            <section id="results" class="doc-section">
                <h2>üìà Resultados</h2>
                
                <div class="results-grid">
                    <div class="result-card">
                        <span class="result-value">R$ 847.293</span>
                        <span class="result-label">Faturamento Total</span>
                        <span class="result-change positive">+48.9%</span>
                    </div>
                    
                    <div class="result-card">
                        <span class="result-value">12.847</span>
                        <span class="result-label">Clientes Ativos</span>
                        <span class="result-change positive">+23.4%</span>
                    </div>
                    
                    <div class="result-card">
                        <span class="result-value">R$ 65,90</span>
                        <span class="result-label">Ticket M√©dio</span>
                        <span class="result-change positive">+12.1%</span>
                    </div>
                    
                    <div class="result-card">
                        <span class="result-value">3.2x</span>
                        <span class="result-label">ROI M√©dio</span>
                        <span class="result-change positive">+18.5%</span>
                    </div>
                </div>
                
                <h3>Principais Insights</h3>
                <div class="insights-list">
                    <div class="insight-item">
                        <span class="insight-number">1</span>
                        <div class="insight-content">
                            <h4>Crescimento Consistente</h4>
                            <p>O faturamento apresentou crescimento m√©dio de 4% ao m√™s, com picos em mar√ßo e novembro.</p>
                        </div>
                    </div>
                    
                    <div class="insight-item">
                        <span class="insight-number">2</span>
                        <div class="insight-content">
                            <h4>Segmento Premium</h4>
                            <p>20% dos clientes representam 78% do faturamento, indicando forte concentra√ß√£o no segmento premium.</p>
                        </div>
                    </div>
                    
                    <div class="insight-item">
                        <span class="insight-number">3</span>
                        <div class="insight-content">
                            <h4>Oportunidade Regional</h4>
                            <p>A regi√£o Nordeste apresenta potencial de crescimento de 35% com estrat√©gia de expans√£o focada.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- C√ìDIGO PYTHON -->
            <section id="code" class="doc-section">
                <h2>üêç C√≥digo Python</h2>
                
                <p>Abaixo est√° o c√≥digo Python utilizado para realizar as an√°lises:</p>
                
                <div class="code-block">
                    <div class="code-header">
                        <span>main.py</span>
                        <button onclick="copyCode()">üìã Copiar</button>
                    </div>
                    <pre><code class="python"># ============================================
# ANALYSTIC.A ‚Äî An√°lise de Dados
# ============================================
import pandas as pd
import plotly.express as px
import numpy as np
from sklearn.cluster import KMeans

# Carregar dados
df = pd.read_excel('vendas_2025.xlsx')

# An√°lise estat√≠stica
print("üìä RESUMO ESTAT√çSTICO")
print(df.describe())

# An√°lise por regi√£o
vendas_regiao = df.groupby('regiao')['valor'].sum()
print("\nüí∞ Vendas por Regi√£o:")
print(vendas_regiao.sort_values(ascending=False))

# Segmenta√ß√£o de clientes
X = df[['valor', 'quantidade']].values
kmeans = KMeans(n_clusters=3, random_state=42)
df['segmento'] = kmeans.fit_predict(X)

# Visualiza√ß√£o
fig = px.line(df.groupby('mes')['valor'].sum().reset_index(),
              x='mes', y='valor', title='Evolu√ß√£o de Vendas')
fig.write_html('dashboard.html')

print("\n‚úÖ An√°lise conclu√≠da com sucesso!")</code></pre>
                </div>
            </section>

            <!-- VISUALIZA√á√ïES -->
            <section id="charts" class="doc-section">
                <h2>üìä Visualiza√ß√µes</h2>
                
                <div class="chart-gallery">
                    <div class="gallery-item">
                        <h4>Evolu√ß√£o de Vendas</h4>
                        <div id="doc-chart-1" class="gallery-chart"></div>
                    </div>
                    
                    <div class="gallery-item">
                        <h4>Distribui√ß√£o por Categoria</h4>
                        <div id="doc-chart-2" class="gallery-chart"></div>
                    </div>
                </div>
            </section>

            <!-- CONCLUS√ïES -->
            <section id="conclusions" class="doc-section">
                <h2>‚úÖ Conclus√µes</h2>
                
                <div class="editable-content" contenteditable="true">
                    <p>Com base nas an√°lises realizadas, conclu√≠mos que:</p>
                    
                    <ol>
                        <li><strong>Crescimento s√≥lido:</strong> A empresa apresentou crescimento consistente de 48.9% no per√≠odo analisado, superando a m√©dia do setor.</li>
                        
                        <li><strong>Base de clientes qualificada:</strong> A concentra√ß√£o de receita em clientes premium indica uma base s√≥lida e oportunidades de upselling.</li>
                        
                        <li><strong>Potencial de expans√£o:</strong> H√° espa√ßo significativo para crescimento nas regi√µes Norte e Nordeste.</li>
                        
                        <li><strong>Previs√£o positiva:</strong> O modelo preditivo indica continuidade do crescimento para os pr√≥ximos 6 meses.</li>
                    </ol>
                </div>
            </section>

            <!-- PR√ìXIMOS PASSOS -->
            <section id="next-steps" class="doc-section">
                <h2>üöÄ Pr√≥ximos Passos</h2>
                
                <div class="steps-timeline">
                    <div class="step-item">
                        <div class="step-marker">1</div>
                        <div class="step-content">
                            <h4>Curto Prazo (1-3 meses)</h4>
                            <ul>
                                <li>Implementar dashboard em tempo real</li>
                                <li>Configurar alertas autom√°ticos</li>
                                <li>Treinar equipe no uso das ferramentas</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="step-item">
                        <div class="step-marker">2</div>
                        <div class="step-content">
                            <h4>M√©dio Prazo (3-6 meses)</h4>
                            <ul>
                                <li>Expandir an√°lise para dados de marketing</li>
                                <li>Integrar com CRM</li>
                                <li>Desenvolver modelo de churn prediction</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="step-item">
                        <div class="step-marker">3</div>
                        <div class="step-content">
                            <h4>Longo Prazo (6-12 meses)</h4>
                            <ul>
                                <li>Implementar IA para recomenda√ß√µes</li>
                                <li>Automatizar relat√≥rios mensais</li>
                                <li>Expandir para an√°lise prescritiva</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- RODAP√â DO DOCUMENTO -->
            <footer class="doc-footer">
                <div class="footer-info">
                    <p><strong>ANALYSTIC.A PRO</strong> ‚Äî Plataforma Premium de An√°lise de Dados</p>
                    <p>Documento gerado automaticamente em {{ now }}</p>
                </div>
                <div class="footer-logo">üìä ANALYSTIC.A</div>
            </footer>

        </main>
    </div>

</div>

<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

<script>
// Gr√°fico de exemplo 1
Plotly.newPlot('doc-chart-1', [{
    x: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
    y: [45000, 52000, 48000, 61000, 55000, 67000],
    type: 'scatter',
    mode: 'lines+markers',
    fill: 'tozeroy',
    line: { color: '#00d4ff' }
}], {
    paper_bgcolor: 'transparent',
    plot_bgcolor: 'transparent',
    font: { color: '#e0e0e0' },
    margin: { l: 40, r: 20, t: 20, b: 40 }
}, { responsive: true });

// Gr√°fico de exemplo 2
Plotly.newPlot('doc-chart-2', [{
    values: [35, 25, 20, 15, 5],
    labels: ['Varejo', 'Servi√ßos', 'Tech', 'Ind√∫stria', 'Outros'],
    type: 'pie',
    hole: 0.4,
    marker: { colors: ['#00d4ff', '#7c3aed', '#10b981', '#f59e0b', '#ef4444'] }
}], {
    paper_bgcolor: 'transparent',
    font: { color: '#e0e0e0' },
    margin: { l: 20, r: 20, t: 20, b: 20 },
    showlegend: false
}, { responsive: true });

// Navega√ß√£o suave
document.querySelectorAll('.docs-nav a').forEach(link => {
    link.addEventListener('click', function(e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        target.scrollIntoView({ behavior: 'smooth' });
        
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        this.classList.add('active');
    });
});

// Exporta√ß√µes
function exportDocPDF() {
    showNotification('Gerando PDF...', 'info');
    window.print();
}

function exportDocHTML() {
    showNotification('Exportando HTML...', 'info');
}

function exportDocMD() {
    showNotification('Exportando Markdown...', 'info');
}

function exportDocWord() {
    showNotification('Exportando Word...', 'info');
}

function copyCode() {
    const code = document.querySelector('.code-block code').textContent;
    navigator.clipboard.writeText(code);
    showNotification('C√≥digo copiado!', 'success');
}

function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.textContent = message;
    document.body.appendChild(notification);
    setTimeout(() => notification.remove(), 3000);
}
</script>

<style>
.docs-container {
    padding: 30px;
    max-width: 1600px;
    margin: 0 auto;
}

.page-header {
    text-align: center;
    margin-bottom: 40px;
}

.docs-layout {
    display: grid;
    grid-template-columns: 250px 1fr;
    gap: 30px;
}

.docs-sidebar {
    position: sticky;
    top: 20px;
    height: fit-content;
}

.docs-sidebar h3 {
    font-size: 1rem;
    margin-bottom: 15px;
    color: var(--text-muted);
}

.docs-nav {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.nav-item {
    padding: 10px 15px;
    border-radius: 8px;
    color: var(--text-secondary);
    text-decoration: none;
    transition: all 0.2s;
}

.nav-item:hover, .nav-item.active {
    background: var(--bg-secondary);
    color: var(--accent-color);
}

.export-sidebar {
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid var(--border-color);
}

.export-sidebar h4 {
    font-size: 0.9rem;
    margin-bottom: 15px;
}

.btn-export-doc {
    display: block;
    width: 100%;
    padding: 10px;
    margin-bottom: 8px;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    color: var(--text-primary);
    cursor: pointer;
    transition: all 0.2s;
}

.btn-export-doc:hover {
    background: var(--accent-color);
    color: white;
}

.docs-content {
    background: var(--bg-secondary);
    border-radius: 16px;
    padding: 40px;
}

.doc-section {
    margin-bottom: 50px;
    padding-bottom: 30px;
    border-bottom: 1px solid var(--border-color);
}

.doc-section h2 {
    font-size: 1.8rem;
    margin-bottom: 25px;
    color: var(--accent-color);
}

.doc-section h3 {
    font-size: 1.2rem;
    margin: 25px 0 15px;
}

.project-info-card {
    background: var(--bg-tertiary);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 25px;
}

.info-row {
    display: flex;
    padding: 10px 0;
    border-bottom: 1px solid var(--border-color);
}

.info-row:last-child { border-bottom: none; }

.info-label {
    width: 200px;
    font-weight: 600;
    color: var(--text-muted);
}

.info-value {
    flex: 1;
}

.editable-content {
    line-height: 1.8;
    padding: 15px;
    border-radius: 8px;
    border: 1px dashed var(--border-color);
}

.editable-content:focus {
    outline: none;
    border-color: var(--accent-color);
}

.data-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
}

.data-table th, .data-table td {
    padding: 12px 15px;
    text-align: left;
    border: 1px solid var(--border-color);
}

.data-table th {
    background: var(--bg-tertiary);
    font-weight: 600;
}

.code-block {
    background: #1e1e2e;
    border-radius: 12px;
    overflow: hidden;
    margin: 20px 0;
}

.code-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 15px;
    background: #2d2d3d;
    font-size: 0.85rem;
}

.code-block pre {
    padding: 20px;
    margin: 0;
    overflow-x: auto;
    font-family: 'Fira Code', monospace;
    font-size: 0.9rem;
    line-height: 1.6;
}

.analysis-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
}

.analysis-card {
    background: var(--bg-tertiary);
    padding: 25px;
    border-radius: 12px;
    text-align: center;
}

.analysis-icon { font-size: 2.5rem; }
.analysis-card h4 { margin: 15px 0 10px; }
.analysis-card p { color: var(--text-muted); font-size: 0.9rem; }

.results-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
    margin-bottom: 30px;
}

.result-card {
    background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
    padding: 25px;
    border-radius: 12px;
    text-align: center;
    border: 1px solid var(--border-color);
}

.result-value {
    display: block;
    font-size: 2rem;
    font-weight: 700;
    color: var(--accent-color);
}

.result-label {
    display: block;
    margin: 10px 0;
    color: var(--text-muted);
}

.result-change {
    font-size: 0.9rem;
    padding: 4px 10px;
    border-radius: 20px;
}

.result-change.positive {
    background: rgba(16, 185, 129, 0.2);
    color: #10b981;
}

.insights-list {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.insight-item {
    display: flex;
    gap: 20px;
    padding: 20px;
    background: var(--bg-tertiary);
    border-radius: 12px;
}

.insight-number {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--accent-color);
    color: white;
    border-radius: 50%;
    font-weight: 700;
}

.insight-content h4 { margin: 0 0 10px; }
.insight-content p { margin: 0; color: var(--text-secondary); }

.chart-gallery {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 25px;
}

.gallery-item {
    background: var(--bg-tertiary);
    padding: 20px;
    border-radius: 12px;
}

.gallery-item h4 { margin: 0 0 15px; text-align: center; }
.gallery-chart { height: 250px; }

.steps-timeline {
    position: relative;
    padding-left: 40px;
}

.steps-timeline::before {
    content: '';
    position: absolute;
    left: 15px;
    top: 0;
    bottom: 0;
    width: 2px;
    background: var(--border-color);
}

.step-item {
    position: relative;
    margin-bottom: 30px;
}

.step-marker {
    position: absolute;
    left: -40px;
    width: 30px;
    height: 30px;
    background: var(--accent-color);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    color: white;
}

.step-content {
    background: var(--bg-tertiary);
    padding: 20px;
    border-radius: 12px;
}

.step-content h4 { margin: 0 0 15px; }
.step-content ul { margin: 0; padding-left: 20px; }
.step-content li { margin-bottom: 8px; }

.doc-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-top: 30px;
    margin-top: 30px;
    border-top: 2px solid var(--border-color);
}

.footer-info p {
    margin: 5px 0;
    color: var(--text-muted);
    font-size: 0.9rem;
}

.footer-logo {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--accent-color);
}

@media print {
    .docs-sidebar { display: none; }
    .docs-layout { grid-template-columns: 1fr; }
    .editable-content { border: none; }
}

@media (max-width: 768px) {
    .docs-layout { grid-template-columns: 1fr; }
    .docs-sidebar { display: none; }
    .results-grid { grid-template-columns: repeat(2, 1fr); }
    .chart-gallery { grid-template-columns: 1fr; }
}
</style>
{% endblock %}
